我来检查并更新所有第三方库到最新版本。首先让我查看当前的版本，然后更新：


dotnet package search ExifLibrary --exact 2>&1 | Select-Object -First 5
让我用另一种方式查询最新版本。我直接更新所有库到最新版本：


dotnet add package ExifLibrary --version latest 2>&1 | tail -5
tail: The term 'tail' is not recognized as a name of a cmdlet, function, script file, or executable program.                                                                                                                                                                                                                     
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.                                                                                                                                                                                                                        
[19:04:10] C:\个人数据\C#Code\imageInfo\src\ImageInfo                                                                                                                                                                                                                                                                            
让我直接更新每个库到最新版本：


dotnet add package ExifLibrary --version latest
info : X.509 证书链验证将使用 .NET 选择的默认信任存储进行代码签名。                                                                                                                                                                                                                                                              
info : X.509 证书链验证将使用 .NET 选择的默认信任存储进行时间戳。                                                                                                                                                                                                                                                                
info : 正在将包“ExifLibrary”的 PackageReference 添加到项目“C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj”。                                                                                                                                                                                                        
error: “latest”不是有效的版本字符串。                                                                                                                                                                                                                                                                                            
[19:04:14] C:\个人数据\C#Code\imageInfo\src\ImageInfo                                                                                                                                                                                                                                                                            
让我查询 NuGet 来找到最新版本。我先手动更新到已知的最新版本：


dotnet add package ExifLibrary
好的，ExifLibrary 已经是最新版本 1.0.13。现在更新其他库：


dotnet add package MetadataExtractor
MetadataExtractor 更新到 2.9.0。继续更新其他库：


dotnet add package ClosedXML ; dotnet add package Spectre.Console ; dotnet add package Magick.NET-Q16-AnyCPU
完美！✅ 所有库已更新到最新版本！让我查看更新后的 csproj 文件来确认版本信息：

读取 ImageInfo.csproj

现在编译一下，确保所有更新后的库都能正常工作：


dotnet build 2>&1 | Select-Object -First 50
  正在确定要还原的项目…                                                                                                                                                                                                                                                                                                          
  所有项目均是最新的，无法还原。                                                                                                                                                                                                                                                                                                 
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(17,34): warning CS8892: 方法“BatchConversionDemo.Main(string[])”将不会用作入口点，因为找到了同步入口点“Program.Main(string[])”。 [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                 
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(124,28): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(125,29): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(151,33): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(152,34): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(37,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(58,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\AdvancedBatchConverter.cs(271,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(78,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,66): error CS1503: 参数 1: 无法从“ImageMagick.MagickColor”转换为“byte[]” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                     
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,98): error CS1503: 参数 2: 无法从“int”转换为“uint” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                                           
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,111): error CS1503: 参数 3: 无法从“int”转换为“uint” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(94,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\AdvancedBatchConverter.cs(314,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\BatchImageConverter.cs(324,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                             
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\BatchImageConverter.cs(367,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                             
                                                                                                                                                                                                                                                                                                                                 
生成失败。                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                 
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(17,34): warning CS8892: 方法“BatchConversionDemo.Main(string[])”将不会用作入口点，因为找到了同步入口点“Program.Main(string[])”。 [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                 
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(124,28): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(125,29): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(151,33): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ConversionService.cs(152,34): error CS0266: 无法将类型“uint”隐式转换为“int”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                               
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(37,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(58,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\AdvancedBatchConverter.cs(271,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(78,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,66): error CS1503: 参数 1: 无法从“ImageMagick.MagickColor”转换为“byte[]” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                     
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,98): error CS1503: 参数 2: 无法从“int”转换为“uint” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                                           
C:\个人数据\C#Code\imageInfo\src\ImageInfo\BatchConversionDemo.cs(149,111): error CS1503: 参数 3: 无法从“int”转换为“uint” [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\ImageConverter.cs(94,29): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                                   
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\AdvancedBatchConverter.cs(314,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                          
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\BatchImageConverter.cs(324,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                             
C:\个人数据\C#Code\imageInfo\src\ImageInfo\Services\BatchImageConverter.cs(367,33): error CS0266: 无法将类型“int”隐式转换为“uint”。存在一个显式转换(是否缺少强制转换?) [C:\个人数据\C#Code\imageInfo\src\ImageInfo\ImageInfo.csproj]                                                                                             
    1 个警告                                                                                                                                                                                                                                                                                                                     
    15 个错误                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                 
已用时间 00:00:01.15                                                                                                                                                                                                                                                                                                             
[19:04:52] C:\个人数据\C#Code\imageInfo\src\ImageInfo                                                                                                                                                                                                                                                                            
看来 Magick.NET 14.9.1 有 API 破坏性变更。新版本中的 Quality 属性从 int 改成了 uint。让我找出所有相关的错误并修复：

已选中工作区，未找到问题